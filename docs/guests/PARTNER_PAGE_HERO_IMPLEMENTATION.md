# Partner Page — Hero Animation Implementation

## Overview

Adds a `/partner` route to the guests app — the "Become a Partner" landing page,
accessible via the "Become a partner" button in the site header.

The hero section features a sequential animation built around the **visibility
theme**: a branded map pin appears from darkness (spotlit from above), then
lands on a real vector map of the Bay of Kotor at Seljanovo — communicating
that joining the network puts a business "on the map".

---

## Files Created / Modified

### New files

| File | Purpose |
|---|---|
| `apps/guests/components/PartnerMapPin.tsx` | Branded SVG map pin component (gold gradients, Montenegro SELECT text, yacht silhouette) |
| `apps/guests/components/sections/PartnerHeroSection.tsx` | Animated hero section — full phase-based animation orchestration |
| `apps/guests/app/partner/page.tsx` | `/partner` route — hero + three stub sections |
| `apps/guests/lib/bay-of-kotor-map.ts` | **Generated** — Bay of Kotor SVG path data (coastlines, place labels, Seljanovo coords) |
| `scripts/generate-bay-of-kotor-map.js` | Node.js script to regenerate the map data from OSM via Overpass API |
| `docs/guests/PARTNER_PAGE_HERO_IMPLEMENTATION.md` | This document |

### Modified files

| File | Change |
|---|---|
| `apps/guests/components/Header.tsx` | Added "Become a partner" outline-gold button (hidden on `/partner` itself) |
| `apps/guests/components/sections/FinalCTASection.tsx` | Added secondary partner CTA link below the email form |
| `apps/guests/locales/en.json` | Added `partner.*` and `finalCta.partnerCopy` keys |
| `apps/guests/locales/me.json` | Montenegrin translations for the above |
| `package.json` | Added `generate:bay-of-kotor` script |

---

## Animation Sequence

All animation is phase-driven (same state-machine pattern as `HeroSectionAnimated`).
Phases advance via `setTimeout` chains; `prefers-reduced-motion` jumps to `complete`.

```
idle (0ms)
  │ +350ms
light-appear      → gold spotlight fades in at top-centre (box-shadow, no DOM element)
  │ +700ms
pin-reveal        → PartnerMapPin fades in, large (200 × 261 px), centred in section
  │ +1300ms
pin-visible       → brief hold while pin is fully illuminated
  │ +550ms
map-reveal        → Bay of Kotor SVG fades in from bottom (52 vh) simultaneously:
                    pin scales to 0.13 × and translates to Seljanovo (CSS transform)
  │ +1100ms
pin-land          → pin arrives; settle tick (no DOM bounce — kept in transform space)
  │ +180ms
text-reveal       → headline + subheadline clip-path reveal from left
  │ +~210ms
cta-slide         → CTA button fades + slides up
  │ +380ms
complete          → static final state
```

**Total animation duration (desktop): ~4.8 seconds**

---

## The SVG Map

### Source data

Generated by `scripts/generate-bay-of-kotor-map.js` using the Overpass API:

```
pnpm generate:bay-of-kotor
```

- **Bounding box:** `42.34°N–42.535°N, 18.43°E–18.82°E`
- **OSM data:** 89 coastline ways → stitched into 15 polygon chains
- **ViewBox:** `0 0 900 540` (equirectangular projection)
- **Places fetched:** 220 OSM nodes — filtered to priority ≤ 2 in the component

### Styling

| Element | Color |
|---|---|
| Water background | `#030914` (navy-900) |
| Land polygons | `#0c2238` (navy-600) |
| Coastline stroke | `rgba(194,162,77,0.22)` (gold, subtle) |
| Place labels | `rgba(232,230,225,0.55)` (cream-muted) |
| Seljanovo label + dot | `#c2a24d` (brand gold) |

### Seljanovo coordinates

Seljanovo (42.432°N, 18.690°E) maps to **SVG coordinates: x=600, y=285** in the
900×540 viewBox. The pin tip lands here via screen-space coordinate calculation
using `getBoundingClientRect()` on a transparent reference circle element.

---

## The Map Pin SVG

`PartnerMapPin.tsx` is a fully inline React SVG component (no `<img>` or file
reference) with:

- **Teardrop body** — bezier path, `radialGradient` from `#f5e08a` (highlight)
  to `#4f411d` (deep shadow)
- **Right-side depth shadow** — `linearGradient` overlay for 3-D depth
- **Specular sheen** — upper-left radial highlight oval, opacity 0.38
- **Navy inner window** — `radialGradient` circle at centre
- **Yacht silhouette** — simplified SVG paths, brand gold, clipped to window
- **Beveled ring** — `linearGradient` stroke at r=80
- **`textPath` arcs** — "Montenegro" (Cormorant Garamond) and "SELECT" (Inter)
  follow the ring's curvature
- **`overflow: visible`** — allows the `drop-shadow` filter to paint outside bounds

---

## Pin Landing Coordinate Calculation

At `map-reveal` phase start (~3.1 s), before triggering the transform:

1. `seljanovoRef.current.getBoundingClientRect()` → screen coords of the
   invisible reference `<circle>` placed at `BOK_SELJANOVO` in the map SVG
2. `sectionRef.current.getBoundingClientRect()` → section bounds
3. **Section centre** = the pin's anchor point (`top: 50%; left: 50%`)
4. `dx = selX - anchorX`
5. `dy = selY - anchorY - (PIN_H / 2 * FINAL_SCALE)`
   (subtraction aligns the pin **tip** — not centre — with Seljanovo)
6. Final CSS: `transform: translate(calc(-50% + ${dx}px), calc(-50% + ${dy}px)) scale(0.13)`

This adapts correctly to any viewport size because it uses live DOM measurements.

---

## Light Source

Same box-shadow technique as `HeroSectionAnimated`:

```css
box-shadow:
  0 0 28vmin 16vmin rgba(194,162,77,0.38),  /* inner glow */
  0 0 60vmin 38vmin rgba(194,162,77,0.16),  /* mid glow  */
  0 0 95vmin 60vmin rgba(194,162,77,0.06);  /* outer halo */
```

Anchored at `top: 0; left: 50%` (top-centre stage spotlight), does **not**
move horizontally (unlike the main hero where it slides to the right).

---

## Stub Sections

Three placeholder sections below the hero with correct brand styling:

- `#benefits` — "Reach guests who are ready to spend"
- `#how-it-works` — "How it works"
- `#apply` — Application form anchor with `mailto:` CTA

These are ready to be replaced with real content sections.

---

## To Regenerate the Map

If the Bay of Kotor area data needs updating:

```bash
pnpm generate:bay-of-kotor
```

Requires internet access. Overwrites `apps/guests/lib/bay-of-kotor-map.ts`.
